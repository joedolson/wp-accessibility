(()=>{(function(e){"use strict";if(wpald.type==="link"){let o=function(a,t,r){var l=a.attr("alt");l===""&&(l="<code>"+a.attr("src").replace(wpald.home,"")+"</code>");var i=document.body.className.split(/\s+/),n="";e.each(i,function(c,p){p.match(/postid-/gi)&&(n=p.replace("postid-","",p)),p.match(/page-id-/gi)&&(n=p.replace("page-id-","",p))});var s=new URL(r);s.searchParams.set("referrer",n),s.toString();var d=a.attr("class");a.wrap('<div class="wpa-ld" />'),a.parent(".wpa-ld").addClass(d),a.attr("alt","").attr("class",""),a.parent(".wpa-ld").append('<a href="'+s+'" class="longdesc-link">Description<span> of '+l+"</span></a>")},h=function(a){var t=a.attr("class").replace("wp-image-",""),r=wpald.url+"/"+t;e.get(r).done(function(l){var i={attachment:l},n=l.description.rendered;if(n=n.replace(/(<([^>]+)>)/gi,"").trim(),n!==""){var s=new URL(wpald.home);console.log(l.link),s.searchParams.set("longdesc",t),s.searchParams.set("p",t),s.toString(),o(a,t,s)}}).fail(function(){console.log("cannot load media for longdesc on "+t)})};e("img[longdesc]").each(function(){var a=e(this).attr("longdesc"),t=e(this).attr("alt"),r=e(this).attr("class");e(this).wrap('<div class="wpa-ld" />'),e(this).parent(".wpa-ld").addClass(r),e(this).attr("alt","").attr("class",""),e(this).parent(".wpa-ld").append('<a href="'+a+'" class="longdesc-link">Description<span> of'+t+"</span></a>")}),e("figure.is-style-longdesc").each(function(){var a=e(this).find("img");h(a)})}else{let o=function(a,t,r,l){var i=a.attr("class");a.attr("class","").attr("longdesc",r),a.attr("id","longdesc-return-"+t),a.wrap('<div class="wpa-ld" />'),a.parent(".wpa-ld").addClass(i),a.parent(".wpa-ld").append('<button aria-expanded="false" class="wpa-toggle">'+wpald.text+"</button>"),a.parent(".wpa-ld").append('<div class="longdesc"></div>');var n=a.parent(".wpa-ld").children(".longdesc");n.hide(),console.log(r),n.load(r+" #desc_"+t,{limit:25},function(s,d,c){d==="error"&&n.html(l)}),a.parent(".wpa-ld").children("button").on("click",function(s){s.preventDefault();var d=n.is(":visible");d?(e(this).attr("aria-expanded","false"),n.hide()):(e(this).attr("aria-expanded","true"),n.show(150))})},h=function(a){var t=a.attr("class");t===""&&(t=a.parent(".wpa-alt").attr("class").replace("wpa-alt ",""));var r=t.replace("wp-image-",""),l=wpald.url+"/"+r;e.get(l).done(function(i){var n={attachment:i},s=i.description.rendered;if(s=s.replace(/(<([^>]+)>)/gi,"").trim(),s!==""){var d=new URL(i.link);d.searchParams.set("longdesc",r),d.toString(),o(a,r,d,s)}}).fail(function(){console.log("cannot load media for longdesc on "+r)})};e("img[longdesc]").each(function(){var a=e(this).attr("longdesc"),t=e(this),r=t.attr("class"),l=t.attr("class").match(/\S+/g),i="";if(e.each(l,function(d,c){c.match(/wp-image-/gi)&&(i=c)}),i===""){var n=t.attr("id");i=n.replace("longdesc-return-","")}t.attr("class",""),t.wrap('<div class="wpa-ld" />'),t.parent(".wpa-ld").addClass(r),t.parent(".wpa-ld").append('<button aria-expanded="false" type="button" class="wpa-toggle">'+wpald.text+"</button>"),t.parent(".wpa-ld").append('<div class="longdesc"></div>');var s=t.parent(".wpa-ld").children(".longdesc");s.hide(),s.load(a+" #desc_"+i),t.parent(".wpa-ld").children("button").on("click",function(d){var c=s.is(":visible");c?(e(this).attr("aria-expanded","false"),s.hide()):(e(this).attr("aria-expanded","true"),s.show(150))})}),e("figure.is-style-longdesc").each(function(){var a=e(this).find("img");h(a)})}})(jQuery);})();
