(()=>{(()=>{"use strict";let p=(s,e)=>{s.parentElement.insertBefore(e,s),e.appendChild(s)},o=document.querySelectorAll("img[longdesc]");if(wpald.type==="link"){o.length>0&&o.forEach(e=>{let r=document.createElement("div");r.classList.add("wpa-ld");let n=e.getAttribute("longdesc"),t=e.getAttribute("alt"),a=[...img.classList];p(e,r),a.forEach(c=>{r.classList.add(c)}),e.setAttribute("class","");let i=document.createElement("a");i.setAttribute("href",n),i.classList.add("longdesc-link"),i.innerHTML='Description<span class="screen-reader-text"> of'+t+"</span>",e.insertAdjacentElement("afterend",i)});let s=document.querySelectorAll("figure.is-style-longdesc");s.length>0&&s.forEach(e=>{let r=e.querySelector("img");u(r)})}else{o.length>0&&o.forEach(e=>{p(e,wrapper);let r=e.getAttribute("longdesc"),n=e.getAttribute("class").match(/\S+/g),t="";n.forEach(i=>{i.match(/wp-image-/gi)&&(t=i),wrapper.classList.add(i)}),t===""&&(t=e.getAttribute("id").replace("longdesc-return-","")),e.setAttribute("class",""),wrapper.insertAdjacentHTML("beforeend",'<button aria-expanded="false" type="button" class="wpa-toggle">'+wpald.text+"</button>"),wrapper.insertAdjacentHTML('<div class="longdesc"></div>');let a=wrapper.querySelector(".longdesc");a.style.display="none",a.load(r+" #desc_"+t),wrapper.querySelector("button").addEventListener("click",function(){a.checkVisibility()?(this.setAttribute("aria-expanded","false"),a.style.display="none"):(this.setAttribute("aria-expanded","true"),a.style.display="block")})});let s=document.querySelectorAll("figure.is-style-longdesc");s.length>0&&s.forEach(e=>{let r=e.querySelector("img");u(r)})}function u(s){let e=s.getAttribute("class").replace("wp-image-",""),r=wpald.url+"/"+e;fetch(r).then(n=>n.json()).then(n=>{let t=n.description.rendered;if(t=t.replace(/(<([^>]+)>)/gi,"").trim(),t!==""){let a=new URL(wpald.home);a.searchParams.set("longdesc",e),a.searchParams.set("p",e),a.toString(),f(s,e,a,t)}}).catch(n=>{console.log(n)})}function f(s,e,r,n){let t=document.createElement("div");t.classList.add("wpa-ld");let a=s.getAttribute("alt");a===""&&(a="<code>"+s.getAttribute("src").replace(wpald.home,"")+"</code>");let i=document.body.className.split(/\s+/),c="";i.forEach(l=>{l.match(/postid-/gi)&&(c=l.replace("postid-","",l)),l.match(/page-id-/gi)&&(c=l.replace("page-id-","",l))});let g=new URL(r);if(g.searchParams.set("referrer",c),g.toString(),[...s.classList].forEach(l=>{t.classList.add(l)}),p(s,t),s.setAttribute("alt",""),s.setAttribute("class",""),wpald.type==="link")t.insertAdjacentHTML("beforeend",'<a href="'+g+'" class="longdesc-link">Description<span class="screen-reader-text"> of '+a+"</span></a>");else{t.insertAdjacentHTML("beforeend",'<button aria-expanded="false" class="wpa-toggle">'+wpald.text+"</button>"),t.insertAdjacentHTML("beforeend",'<div class="longdesc"></div>');let l=t.querySelector(".longdesc");l.style.display="none",fetch(r).then(d=>{if(d.ok)return d.text();l.insertAdjacentHTML("beforeend",n)}).then(d=>{let b=new DOMParser().parseFromString(d,"text/html");l.insertAdjacentElement("beforeend",b.querySelector("#desc_"+e))}),t.querySelector("button").addEventListener("click",function(d){l.checkVisibility()?(this.setAttribute("aria-expanded","false"),l.style.display="none"):(this.setAttribute("aria-expanded","true"),l.style.display="block")})}}})();})();
